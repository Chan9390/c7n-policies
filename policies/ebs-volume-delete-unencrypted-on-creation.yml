policies:

- name: ebs-volume-delete-unencrypted-on-creation
  comment: "Delete unencrypted EBS volumes on creation."
  resource: ebs
  filters:
    - Encrypted: false
  mode:
    type: cloudtrail
    events:
      - CreateVolume
  actions:
    - delete
    - type: notify
      action_desc: |
        Custodian has deleted the unencrypted volume. Please modify volume
        creation to include encryption.
      to: ["slack"]
      transport:
        type: sqs
        queue: c7nMessageQueue
      violation_desc: "Custodian caught the creation of an unencrypted volume."
